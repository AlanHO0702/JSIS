@page
@using WebRazor.Models
@model PcbErpApi.Pages.CUR.CURdReportOrderBasPageModel

<!-- 套用新的 MasterMultiDetail 樣板 -->
@await Html.PartialAsync(
    "_MasterMultiDetailTemplate",
    new MasterMultiDetailConfig
    {
        DomId = "mmd_reportOrder",

        MasterTitle = "報表設定",
        MasterTable = "CURdReportOrderBas",
        MasterDict  = "CURdReportOrderBas",
        MasterTop   = 500,

        Details = new List<DetailConfig>
        {
            // =======================
            // 使用者設定 ( PK = ItemId + UserId )
            // =======================
            new DetailConfig
            {
                DetailTitle = "使用者設定",
                DetailTable = "CURdReportOrderUser",
                DetailDict  = "CURdReportOrderUser",

                KeyMap = new List<KeyMapMulti>
                {
                    new KeyMapMulti { Master = "ItemId", Detail = "ItemId"  }
                    //new KeyMapMulti { Master = "UserId", Detail = "UserId" }   // ⭐加入 PK
                },
                PkFields = new List<string> { "ItemId", "UserId" }
            },

            // =======================
            // 參數設定 ( PK = ItemId + ParamName )
            // =======================
            new DetailConfig
            {
                DetailTitle = "參數設定",
                DetailTable = "CURdReportOrderParam",
                DetailDict  = "CURdReportOrderParam",

                KeyMap = new List<KeyMapMulti>
                {
                    new KeyMapMulti { Master = "ItemId",    Detail = "ItemId"    }
                    //new KeyMapMulti { Master = "ParamName", Detail = "ParamName" }  // ⭐加入 PK
                },
                PkFields = new List<string> { "ItemId", "ParamName" }
            }
        }
    })

@using PcbErpApi.Models
@await Html.PartialAsync("_FieldDictModal", new List<CURdTableField>(), ViewData)
<script src="~/js/fieldDictModal.js"></script>
