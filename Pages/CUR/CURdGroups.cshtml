@page
@using WebRazor.Models
@model PcbErpApi.Pages.CUR.CURdGroupsPageModel

<!-- 套用新的 MasterMultiDetail 樣板 -->
@await Html.PartialAsync(
    "_MasterMultiDetailTemplate",
    new MasterMultiDetailConfig
    {
        DomId = "mmd_reportOrder",

        MasterTitle = "群組主檔",
        MasterTable = "CURdGroups",
        MasterDict  = "CURdGroups",
        MasterTop   = 500,

        Details = new List<DetailConfig>
        {
            // =======================
            // 使用者設定 ( PK = ItemId + UserId )
            // =======================
            new DetailConfig
            {
                DetailTitle = "群組權限明細檔",
                DetailTable = "CURdGroupItems",
                DetailDict  = "CURdGroupItemsDLL",

                KeyMap = new List<KeyMapMulti>
                {
                    new KeyMapMulti { Master = "GroupId", Detail = "GroupId"  }
                },
                PkFields = new List<string> { "GroupId", "ItemId", "UseId" }
            },

            // =======================
            // 參數設定 ( PK = ItemId + ParamName )
            // =======================
            new DetailConfig
            {
                DetailTitle = "群組成員檔",
                DetailTable = "CURdUserGroup",
                DetailDict  = "CURdUserGroup",

                KeyMap = new List<KeyMapMulti>
                {
                    new KeyMapMulti { Master = "GroupId",    Detail = "GroupId"    }
                },
                PkFields = new List<string> { "GroupId",  "UserId" }
            }
        }
    })

@using PcbErpApi.Models
@await Html.PartialAsync("_FieldDictModal", new List<CURdTableField>(), ViewData)
<script src="~/js/fieldDictModal.js" asp-append-version="true"></script>
