@page
@using WebRazor.Models
@model PcbErpApi.Pages.AJN.AJNdClassMoneyModel

@{
    ViewData["Title"] = "AA000001 幣別匯率主檔";
    Layout = "_Layout";
}

@await Html.PartialAsync(
  "_MasterDetailTemplate",
  new MasterDetailConfig {
      DomId        = "AJNdClassMoneyMD",
      MasterTitle  = "幣別匯率設定",
      DetailTitle  = "幣別匯率設定(日期)",
      MasterTable  = "AJNdClassMoney",
      DetailTable  = "AJNdClassMoneyHis",
      MasterDict   = "AJNdClassMoney",
      DetailDict   = "AJNdClassMoneyHis",

      // ⭐ 主檔 → 明細查詢用
      KeyMap = new [] { 
          new KeyMap("MoneyCode", "MoneyCode"),
          new KeyMap("UseId", "UseId")
      },

      // ⭐ 更新明細資料用（這個才是關鍵！）
      DetailKeyFields = new [] { "MoneyCode", "UseId", "RateDate" },

      MasterTop = 500,
      DetailOrderBy = "RateDate",
      DetailOrderDir = "DESC"
  })
@using PcbErpApi.Models
@await Html.PartialAsync("_FieldDictModal", new List<CURdTableField>(), ViewData)
<script src="~/js/fieldDictModal.js"></script>