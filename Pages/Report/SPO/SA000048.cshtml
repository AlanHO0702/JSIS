@page
@model GenericReportPageModel
@{
    Layout = "_Layout";

    // 這支報表只做「設定」，其餘交給共用樣板
    Model.Config = new ReportConfig {
        Title = "訂單未交貨明細表",
        SpName = "dbo.SPOd訂單未交貨明細表_QU",
        DictTableName = "SA000048",
        ParamDefs = new List<ParamDef> {
            new() { Name="BDelDate", Label="起始交期", Ui=ParamUiType.Date, DefaultValue="today-120d" },
            new() { Name="EDelDate", Label="截止交期", Ui=ParamUiType.Date, DefaultValue="today" },

            // 共用 lookup（打 API）
            new() { Name="CustomerId", Label="客戶代碼", Ui=ParamUiType.Select, LookupKey="customer" },
            new() { Name="UseId",      Label="公司別",   Ui=ParamUiType.Select, LookupKey="bu",       DefaultValue="A001" },
            new() { Name="ShipTerm",   Label="交易條件", Ui=ParamUiType.Select, LookupKey="shipterm" },

            // 本報表固定選項（不打 API）
            new() { Name="IsHold", Label="是否暫停", Ui=ParamUiType.Select, DefaultValue="255",
                    Options = new() { ("0","非暫停"), ("1","暫停中"), ("255","(不限)") } },
            new() { Name="PoType", Label="訂單種類", Ui=ParamUiType.Select, DefaultValue="255",
                    Options = new() { ("0","量產"), ("1","樣品"), ("255","(不限)") } },
            new() { Name="OutNotIn", Label="內製/外包", Ui=ParamUiType.Select, DefaultValue="255",
                    Options = new() { ("0","內製"), ("1","外包"), ("255","(不限)") } },
            new() { Name="IncludeCharge", Label="包含費用", Ui=ParamUiType.Select, DefaultValue="1",
                    Options = new() { ("0","不包含"), ("1","包含"), ("2","僅顯示費用") } },

            // 文字輸入
            new() { Name="CustomerPartNum", Label="客戶料號(模糊)", Ui=ParamUiType.Text },
            new() { Name="PartNum",         Label="品號(模糊)",     Ui=ParamUiType.Text },
            new() { Name="SourCustomerId",  Label="上層客戶",       Ui=ParamUiType.Text },
        }
    };

    Model.LoadDict(Model.Config.DictTableName);

    ViewData["ReportConfig"] = Model.Config;
    ViewData["Fields"]       = Model.TableFields;   // 共用樣板畫表頭/表身會用
    ViewData["FieldDictList"]= Model.FieldDictList; // F3 辭典 modal 用（如你有接）
    ViewData["DictTableName"]= Model.Config.DictTableName;
}

@await Html.PartialAsync("~/Pages/Shared/_ReportScaffold.cshtml", Model, ViewData)
