@model dynamic
@using System.Linq

@{
    // 預期由頁面 model 提供：List<ItemCustButtonRow>
    var buttons = (IEnumerable<dynamic>)(Model?.CustomButtons ?? Enumerable.Empty<dynamic>());
}

@foreach (var b in buttons)
{
    var caption = (b?.Caption ?? b?.CustCaption ?? b?.ButtonName ?? "").ToString();
    if (string.IsNullOrWhiteSpace(caption)) { continue; }

    var hint = (b?.Hint ?? b?.CustHint ?? "").ToString();
    var btnName = (b?.ButtonName ?? "").ToString();

    <button type="button"
            class="fab"
            title="@hint"
            data-custom-btn="1"
            data-button-name="@btnName">
        @caption
    </button>
}

<script>
// 先只把按鈕點擊帶出設定（不執行任何邏輯）
document.querySelectorAll('.action-rail [data-custom-btn="1"]').forEach(btn => {
  btn.addEventListener('click', (e) => {
    const el = e.currentTarget;
    console.log('[CustomButton]', {
      itemId: '@(Model?.ItemId ?? "")',
      buttonName: el.getAttribute('data-button-name') || '',
      caption: (el.textContent || '').trim()
    });
  });
});
</script>

