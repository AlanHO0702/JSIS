@page "/SPO/SPOdPriceTable2"
@model PcbErpApi.Pages.SPO.SPOdPriceTable2Model
@{
    Layout = "_Layout";
    ViewData["Title"] = Model.PageTitle;
    ViewData["EnableRowDelete"] = false;
}

<div class="container-fluid px-3 py-3 @(Model.IsModal ? "price-table-modal" : "")">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
        <div>
            @if (!string.IsNullOrWhiteSpace(Model.LoadError))
            {
                <div class="text-danger small">載入失敗：@Model.LoadError</div>
            }
        </div>
    </div>

    @if (!string.IsNullOrWhiteSpace(Model.LoadError))
    {
        <div class="alert alert-warning">無法載入價格表：@Model.LoadError</div>
    }
    else
    {
        @await Html.PartialAsync("~/Pages/Shared/_TableSingleGrid.cshtml", new
        {
            TableName = Model.TableName,
            Items = Model.Items,
            TableFields = Model.TableFields,
            PageNumber = Model.PageNumber,
            PageSize = Model.PageSize,
            TotalCount = Model.TotalCount
        }, ViewData)
    }
</div>

<style>
  #btnEditToggle,
  #btnSaveTable,
  #btnDeleteRow,
  #btnOpenQuery{
    display:none !important;
  }
  @if (Model.IsModal)
  {
    @:body.with-toolbar{ padding-top:0 !important; }
    @:.app-toolbar{ display:none !important; }
    @:body{ background:#fff !important; }
    @:.price-table-modal{ padding:0 !important; }
    @:.price-table-modal .table-wrapper{ margin:0 !important; padding:0 !important; }
    @:.price-table-modal .card-body{ padding-top:0 !important; }
    @:.price-table-modal table th,
    @:.price-table-modal table td{ padding:0 !important; }
    @:.price-table-modal .cell-view,
    @:.price-table-modal .cell-edit{ padding:0 !important; }
    @:.price-table-modal .cell-text .cell-view,
    @:.price-table-modal .cell-text .cell-edit{ text-align:left !important; padding-left:4px !important; }
    @:.price-table-modal .cell-number .cell-view,
    @:.price-table-modal .cell-number .cell-edit{ text-align:right !important; padding-right:4px !important; }
  }
</style>

<script>
  window._dictTableName = "@Model.DictTableName";
  window._singleGridDateFormat = "date";
</script>

@await Html.PartialAsync("~/Pages/Shared/_FieldDictModal.cshtml", Model.FieldDictList, ViewData)
<script src="~/js/fieldDictModal.js" asp-append-version="true"></script>
