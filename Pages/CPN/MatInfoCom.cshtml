@page "/CPN/{itemId}"
@model PcbErpApi.Pages.CPN.MatInfoComModel
@{
    Layout = "_Layout";
    ViewData["Title"] = $"{Model.ItemId} {Model.ItemName}";
    var itemIdUpper = (Model.ItemId ?? string.Empty).ToUpperInvariant();
    var isProductMat = itemIdUpper == "CPN00006" || itemIdUpper == "MG000008";
    var isQueryMat = itemIdUpper == "CPN00006" || itemIdUpper == "CPN00007";
}

<style>
  .matinfo-page {
    padding: 8px 12px 24px 12px;
  }
  .matinfo-toolbar {
    display: flex;
    justify-content: space-between;
    gap: 8px;
    align-items: center;
    margin-bottom: 8px;
  }
  .matinfo-toolbar-actions {
    display: flex;
    gap: 4px;
    align-items: center;
  }
  .toolbar-count-box {
    display: inline-flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: var(--top-toolbar-btn-height, 36px);
    min-width: 74px;
    padding: 2px 8px;
    border-radius: 6px;
    font-weight: 700;
    line-height: 1.05;
    color: #fff;
    background: #1e4db7;
    user-select: none;
  }
  .toolbar-count-box.mode-edit,
  .toolbar-count-box.mode-view {
    background: #1e4db7;
  }
  .toolbar-count-box.mode-edit {
    background: #f00000;
  }
  .toolbar-count-box .count-line {
    text-align: center;
    font-size: 0.75rem;
  }
  .matinfo-page .toolbar-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    background: #fff;
    color: #1d2b4f;
    border: 1px solid #cfd7e6;
    border-radius: 10px;
    font-size: calc(var(--top-toolbar-font-size) - 2px);
    font-weight: 500;
    padding: 4px 8px;
    box-shadow: none;
    transition: background 0.18s, transform 0.11s, border-color 0.18s;
    cursor: pointer;
  }
  .matinfo-toolbar-actions .toolbar-btn:not(.toolbar-btn-icon) {
    height: var(--top-toolbar-btn-height, 36px);
    justify-content: center;
  }
  .matinfo-page .toolbar-btn.success {
    border-color: #9fd6b3;
    color: #0e7a3a;
  }
  .matinfo-page .toolbar-btn.warning {
    border-color: #f6cf86;
    color: #a76a00;
  }
  .matinfo-page .toolbar-btn.danger {
    border-color: #f0a3aa;
    color: #b4232f;
  }
  .matinfo-page .toolbar-btn:hover,
  .matinfo-page .toolbar-btn:focus {
    transform: translateY(-1px) scale(1.03);
  }
  .matinfo-page .toolbar-btn i {
    font-size: 1.08em;
  }
  .matinfo-toolbar .toolbar-btn-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: var(--top-toolbar-btn-height, 36px);
    min-height: var(--top-toolbar-btn-height, 36px);
    padding: 0;
    width: 30px;
    border-radius: 8px;
    font-size: var(--top-toolbar-icon-font-size, 16px);
    line-height: 1;
  }
  .matinfo-toolbar .toolbar-btn-icon .toolbar-icon {
    display: inline-block;
  }
  .matinfo-toolbar #btnMatInfoTabFirst i,
  .matinfo-toolbar #btnMatInfoTabPrev i,
  .matinfo-toolbar #btnMatInfoTabNext i,
  .matinfo-toolbar #btnMatInfoTabLast i {
    font-size: 16px;
  }
  .matinfo-browse {
    border: 1px solid #d8e0ee;
    border-radius: 8px;
    background: #fff;
    overflow: hidden;
    --browse-row-height: 22px;
    --browse-head-height: 26px;
  }
  .matinfo-browse.is-hidden {
    display: none;
  }
  .matinfo-scroll-top {
    overflow-x: auto;
    overflow-y: hidden;
    height: 14px;
    border-bottom: 1px solid #eef2f8;
  }
  .matinfo-page[data-item-id="MG000008"] .matinfo-scroll-top,
  .matinfo-page[data-item-id="CPN00006"] .matinfo-scroll-top,
  .matinfo-page[data-item-id="MG000002"] .matinfo-scroll-top,
  .matinfo-page[data-item-id="CPN00007"] .matinfo-scroll-top {
    display: none;
  }
  .matinfo-scroll-top > div {
    height: 1px;
  }
  .matinfo-scroll-body {
    overflow-x: auto;
    overflow-y: auto;
    height: calc(var(--browse-head-height) + (var(--browse-row-height) + 2px) * 11 + 34px);
  }
  .matinfo-browse table {
    width: 1px;
    max-width: none;
    border-collapse: collapse;
    font-size: 0.82rem;
    min-width: 1200px;
    table-layout: fixed;
  }
  .matinfo-page[data-item-id="MG000002"] .matinfo-browse {
    width: 100%;
  }
  .matinfo-page[data-item-id="MG000002"] .matinfo-browse table {
    width: 100%;
    min-width: 0;
  }
  .matinfo-browse thead th {
    background: #f2f6ff;
    color: #204a87;
    text-align: left;
    padding: 3px 6px;
    border-bottom: 1px solid #b7c2d4;
    border-right: 1px solid #b7c2d4;
    white-space: nowrap;
    position: relative;
    position: sticky;
    top: 0;
    z-index: 2;
    height: var(--browse-head-height);
  }
  .matinfo-browse thead th .col-resizer {
    position: absolute;
    top: 0;
    right: -2px;
    width: 6px;
    height: 100%;
    cursor: col-resize;
    user-select: none;
  }
  .matinfo-browse thead th .col-resizer::after {
    content: "";
    position: absolute;
    top: 20%;
    right: 2px;
    width: 1px;
    height: 60%;
    background: #c7d3e6;
    opacity: 0;
    transition: opacity 0.12s;
  }
  .matinfo-browse thead th:hover .col-resizer::after {
    opacity: 1;
  }
  .matinfo-browse thead th.sortable {
    cursor: pointer;
  }
  .matinfo-browse thead th.sorted-asc::after {
    content: " ▲";
    font-size: 0.75em;
  }
  .matinfo-browse thead th.sorted-desc::after {
    content: " ▼";
    font-size: 0.75em;
  }
  .matinfo-browse tbody td {
    padding: 2px 6px;
    border-bottom: 1px solid #c4cede;
    border-right: 1px solid #c4cede;
    border-top: 1px solid #c4cede;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
    min-width: 0;
    height: var(--browse-row-height);
  }
  .matinfo-browse thead th:last-child,
  .matinfo-browse tbody td:last-child {
    border-right: none;
  }
  .matinfo-browse tbody td input[type="checkbox"] {
    pointer-events: none;
    width: 12px;
    height: 12px;
  }
  .matinfo-browse .col-checkbox {
    text-align: center;
  }
  .matinfo-browse tbody .col-readonly {
    background: #f3f4f6;
  }
  .matinfo-browse tbody tr:hover {
    background: #f9fbff;
    cursor: pointer;
  }
  .matinfo-browse tbody tr.active {
    background: #cfe8ff;
  }
  .matinfo-browse tbody tr.active td {
    background: #cfe8ff;
  }
  .matinfo-browse-resizer {
    height: 6px;
    cursor: row-resize;
    background: linear-gradient(180deg, #eef3fb 0%, #dbe6f5 100%);
    border-top: 1px solid #cdd7ea;
  }
  .matinfo-browse tbody tr.matinfo-spacer td {
    padding: 0;
    border: none;
  }
  .matinfo-browse tbody tr.matinfo-loading td {
    color: #6b7280;
    font-style: italic;
  }
  .matinfo-tabs {
    margin-top: 6px;
    gap: 2px;
    flex-wrap: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    white-space: nowrap;
    border: 2px solid #9fb3d8;
    border-bottom: none;
    border-radius: 8px 8px 0 0;
    padding: 2px 4px;
    background: #eef3ff;
    box-shadow: 0 2px 6px rgba(35, 61, 120, 0.12);
  }
  .matinfo-tabs .nav-item {
    flex: 0 0 auto;
    margin-right: 2px;
  }
  .matinfo-tabs .nav-link {
    padding: 1px 6px;
    font-size: 0.78rem;
    line-height: 1.15;
    height: 22px;
    display: inline-flex;
    align-items: center;
    border: 1px solid transparent;
    border-bottom: none;
    border-radius: 6px 6px 0 0;
    color: #1f4a8c;
    font-weight: 600;
    background: transparent;
  }
  .matinfo-tabs .nav-link.tab-compact {
    padding: 1px 6px;
    font-size: 0.78rem;
    line-height: 1.15;
    height: 22px;
    display: inline-flex;
    align-items: center;
  }
  .matinfo-tabs .nav-link:hover {
    background: #f7f9ff;
    border-color: #c4cede;
    border-bottom-color: #f7f9ff;
    color: #173a72;
  }
  .matinfo-tabs .nav-link.active {
    color: #0f172a;
    background: #fff;
    border-color: #b7c2d4;
    border-bottom-color: #fff;
    box-shadow: none;
  }
  .matinfo-form {
    border: 2px solid #9fb3d8;
    border-top: none;
    padding: 6px 8px 10px 8px;
    background: #fff;
    overflow-x: auto;
    border-radius: 0 0 8px 8px;
    box-shadow: 0 3px 8px rgba(35, 61, 120, 0.12);
  }
  .matinfo-form .tab-pane {
    min-width: 1080px;
  }
  .matinfo-page.is-edit-mode .matinfo-form input[data-field]:not([readonly]):not([disabled]),
  .matinfo-page.is-edit-mode .matinfo-form textarea[data-field]:not([readonly]):not([disabled]),
  .matinfo-page.is-edit-mode .matinfo-form select[data-field]:not([disabled]) {
    background: #fff7cc;
    border-color: #f59e0b;
  }
  .matinfo-section {
    margin-bottom: 6px;
  }
  .matinfo-section-title {
    display: none;
  }
  .matinfo-grid {
    display: grid;
    grid-template-columns: 80px 180px 80px 180px 80px 180px;
    gap: 4px 12px;
    align-items: center;
  }
  #tab-basic .matinfo-grid,
  #tab-basic2 .matinfo-grid {
    column-gap: 16px;
  }
  .matinfo-grid.compact {
    grid-template-columns: 80px 220px 80px 220px;
  }
  .matinfo-grid label {
    text-align: right;
    color: #1d3b6b;
    font-size: 0.82rem;
    align-self: center;
    white-space: nowrap;
  }
  .matinfo-grid input,
  .matinfo-grid select {
    width: 100%;
    height: var(--browse-row-height);
    padding: 2px 6px;
    border: 1px solid #cfd7e6;
    border-radius: 4px;
    font-size: 0.82rem;
    box-sizing: border-box;
  }
  .matinfo-grid .field-wide {
    grid-column: span 5;
  }
  .matinfo-grid .field-full {
    grid-column: span 5;
  }
  .matinfo-abs-layout {
    position: relative;
    min-height: 200px;
  }
  .matinfo-abs-layout .abs-item {
    position: absolute;
    box-sizing: border-box;
  }
  .matinfo-abs-layout label {
    text-align: right;
    color: #1d3b6b;
    font-size: 0.8rem;
    white-space: nowrap;
  }
  .matinfo-abs-layout input,
  .matinfo-abs-layout select,
  .matinfo-abs-layout textarea {
    width: 100%;
    height: var(--browse-row-height);
    padding: 2px 6px;
    border: 1px solid #cfd7e6;
    border-radius: 4px;
    font-size: 0.82rem;
    box-sizing: border-box;
  }
  .matinfo-abs-layout .abs-checkbox-label {
    text-align: left;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }
  .matinfo-checks {
    display: flex;
    gap: 10px 16px;
    align-items: center;
    flex-wrap: wrap;
  }
  .matinfo-checks label {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    min-width: 90px;
    white-space: nowrap;
    margin: 0;
  }
  .matinfo-checks label {
    text-align: left;
    color: #1d3b6b;
  }
  .matinfo-split {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }
  .matinfo-box {
    border: 1px solid #d8e0ee;
    border-radius: 8px;
    background: #fff;
    padding: 6px;
    overflow-x: auto;
  }
  .matinfo-grid-toolbar {
    display: flex;
    gap: 4px;
    align-items: center;
    margin-bottom: 4px;
  }
  .matinfo-grid-toolbar .btn {
    width: 30px;
    height: 30px;
    min-height: 30px;
    padding: 0;
    border-radius: 8px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    border-width: 1px;
    background: #fff !important;
    box-shadow: none !important;
  }
  .matinfo-grid-toolbar .btn i {
    font-size: 16px;
  }
  .matinfo-grid-toolbar .btn:hover:not(:disabled),
  .matinfo-grid-toolbar .btn:focus-visible:not(:disabled) {
    transform: translateY(-1px);
  }
  .matinfo-grid-toolbar .btn:disabled {
    opacity: .45;
    cursor: not-allowed;
  }
  .matinfo-grid-toolbar .btn.btn-outline-success {
    color: #118a3f !important;
    border-color: #9fd6b3 !important;
  }
  .matinfo-grid-toolbar .btn.btn-outline-danger {
    color: #cc3a3a !important;
    border-color: #efb3b3 !important;
  }
  .matinfo-grid-toolbar .btn.btn-outline-primary {
    color: #1d62d8 !important;
    border-color: #abc4f8 !important;
  }
  .matinfo-grid-toolbar .btn.btn-outline-secondary {
    color: #2a4a7a !important;
    border-color: #b9c7de !important;
  }
  .matinfo-grid-toolbar .btn[id$="First"],
  .matinfo-grid-toolbar .btn[id$="Prev"],
  .matinfo-grid-toolbar .btn[id$="Next"],
  .matinfo-grid-toolbar .btn[id$="Last"] {
    display: none !important;
  }
  .matinfo-grid-toolbar.show-nav .btn[id$="First"],
  .matinfo-grid-toolbar.show-nav .btn[id$="Prev"],
  .matinfo-grid-toolbar.show-nav .btn[id$="Next"],
  .matinfo-grid-toolbar.show-nav .btn[id$="Last"] {
    display: inline-flex !important;
  }
  .matinfo-spec-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: nowrap;
    overflow-x: auto;
    padding-bottom: 2px;
  }
  .matinfo-spec-toolbar .matinfo-grid-toolbar {
    margin-bottom: 0;
  }
  .matinfo-map-toolbar {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 8px;
    flex-wrap: nowrap;
    overflow-x: auto;
    margin-bottom: 8px;
  }
  .matinfo-map-toolbar .matinfo-toolbar-actions,
  .matinfo-map-toolbar .matinfo-grid-toolbar {
    flex: 0 0 auto;
  }
  .matinfo-map-toolbar .matinfo-grid-toolbar {
    margin-bottom: 0;
  }
  .matinfo-spec-nav { flex: 0 0 auto; }
  .matinfo-spec-filters {
    display: grid;
    grid-template-columns: 38px 130px 38px 90px 38px 220px;
    gap: 4px 6px;
    align-items: center;
    width: auto;
    flex: 0 0 auto;
  }
  .matinfo-spec-filters label {
    text-align: right;
    margin: 0;
    font-size: 0.82rem;
  }
  .matinfo-spec-filters input,
  .matinfo-spec-filters select { width: 100%; }
  .matinfo-spec-actions {
    display: flex;
    gap: 4px;
    justify-self: start;
    flex-wrap: nowrap;
    flex: 0 0 auto;
  }
  .matinfo-spec-actions .toolbar-btn {
    height: 30px;
    min-width: 86px;
    padding: 0 8px;
    font-size: 0.8rem;
    white-space: nowrap;
  }
  .matinfo-common-toolbar {
    margin-top: 6px;
    margin-bottom: 0;
  }
  @@media (max-width: 1320px) {
    .matinfo-spec-toolbar {
      flex-wrap: wrap;
      overflow-x: visible;
      align-items: flex-start;
    }
    .matinfo-spec-actions { flex-wrap: wrap; }
  }
  .matinfo-grid-table table {
    width: 1px;
    max-width: none;
    min-width: 0;
    border-collapse: collapse;
    font-size: 0.82rem;
    table-layout: fixed;
  }
  .matinfo-grid-table th,
  .matinfo-grid-table td {
    border: 1px solid #c4cede;
    padding: 2px 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
    min-width: 0;
  }
  .matinfo-grid-table thead th {
    background: #f2f6ff;
    color: #204a87;
    border-color: #b7c2d4;
    font-weight: 600;
  }
  .matinfo-grid-table thead th:last-child {
    border-right: 1px solid #b7c2d4 !important;
  }
  .matinfo-grid-table tbody td:last-child {
    border-right: 1px solid #c4cede !important;
  }
  .matinfo-grid-table {
    border: 1px solid #cfd7e6;
    border-radius: 0;
    background: #fff;
    overflow: auto;
  }
  .matinfo-grid-table tbody tr.is-selected {
    background: #cfe8ff;
  }
  .matinfo-grid-table tbody tr.is-selected td {
    background: #cfe8ff;
    border-color: #9fc6e6;
  }
  .matinfo-grid-table tbody tr.is-deleted {
    opacity: 0.6;
    text-decoration: line-through;
  }
  .matinfo-grid-table input,
  .matinfo-grid-table select {
    width: 100%;
    height: var(--browse-row-height);
    padding: 2px 6px;
    border: 1px solid #cfd7e6;
    border-radius: 4px;
    font-size: 0.82rem;
    box-sizing: border-box;
  }
  .matinfo-box table {
    width: 1px;
    max-width: none;
    border-collapse: collapse;
    font-size: 0.82rem;
    min-width: 0;
    table-layout: fixed;
  }
  .matinfo-form .tab-pane:not(#tab-basic):not(#tab-basic2):not(#tab-prop):not(#tab-glyph) table {
    font-size: 0.82rem;
    border-collapse: collapse;
    width: 1px;
    max-width: none;
    min-width: 0;
    table-layout: fixed;
  }
  .matinfo-form .tab-pane:not(#tab-basic):not(#tab-basic2):not(#tab-prop):not(#tab-glyph) thead th {
    background: #f2f6ff;
    color: #204a87;
    text-align: left;
    padding: 3px 6px;
    border-bottom: 1px solid #b7c2d4;
    border-right: 1px solid #b7c2d4;
    white-space: nowrap;
    height: var(--browse-head-height);
  }
  .matinfo-form .tab-pane:not(#tab-basic):not(#tab-basic2):not(#tab-prop):not(#tab-glyph) thead th:last-child {
    border-right: 1px solid #b7c2d4;
  }
  .matinfo-form .tab-pane:not(#tab-basic):not(#tab-basic2):not(#tab-prop):not(#tab-glyph) tbody td {
    padding: 2px 6px;
    border-bottom: 1px solid #c4cede;
    border-right: 1px solid #c4cede;
    border-top: 1px solid #c4cede;
    white-space: nowrap;
    height: var(--browse-row-height);
  }
  .matinfo-form .tab-pane:not(#tab-basic):not(#tab-basic2):not(#tab-prop):not(#tab-glyph) tbody td:last-child {
    border-right: 1px solid #c4cede;
  }
  .matinfo-form .tab-pane:not(#tab-basic):not(#tab-basic2):not(#tab-prop):not(#tab-glyph) tbody tr:hover {
    background: #f9fbff;
  }
  .matinfo-form table.matinfo-resizable {
    width: 1px;
    min-width: 0;
  }
  .matinfo-grid-table .cell-view,
  .matinfo-grid-table .cell-edit {
    display: block;
    width: 100%;
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
    box-sizing: border-box;
  }
  .matinfo-box th,
  .matinfo-box td {
    border-bottom: 1px solid #c4cede;
    border-right: 1px solid #c4cede;
    border-top: 1px solid #c4cede;
    padding: 2px 6px;
    text-align: left;
    white-space: nowrap;
  }
  .matinfo-box thead th:last-child,
  .matinfo-box tbody td:last-child {
    border-right: 1px solid #c4cede;
  }
  .matinfo-box thead th {
    background: #f2f6ff;
    color: #204a87;
    border-bottom: 1px solid #b7c2d4;
    border-right: 1px solid #b7c2d4;
    font-weight: 600;
  }
  .matinfo-form table thead th {
    position: relative;
  }
  .matinfo-form table thead th .col-resizer {
    position: absolute;
    top: 0;
    right: -2px;
    width: 6px;
    height: 100%;
    cursor: col-resize;
    user-select: none;
  }
  .matinfo-form table thead th .col-resizer::after {
    content: "";
    position: absolute;
    top: 20%;
    right: 2px;
    width: 1px;
    height: 60%;
    background: #c7d3e6;
    opacity: 0;
    transition: opacity 0.12s;
  }
  .matinfo-form table thead th:hover .col-resizer::after {
    opacity: 1;
  }
  .matinfo-textarea {
    width: 100%;
    min-height: 140px;
    padding: 8px;
    border: 1px solid #cfd7e6;
    border-radius: 6px;
    resize: vertical;
  }
  .matinfo-image-box {
    border: 1px solid #d8e0ee;
    border-radius: 8px;
    background: #fafcff;
    min-height: 220px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6b7280;
    font-weight: 600;
  }
  .lookup-dropdown-list {
    background: #fff;
    border: 1px solid #d8e0ee;
    border-radius: 8px;
    box-shadow: 0 8px 18px rgba(15, 23, 42, 0.18);
    padding: 6px;
    overflow: auto;
    z-index: 1060;
  }
  .lookup-dropdown-item {
    display: block;
    width: 100%;
    text-align: left;
    border: none;
    background: transparent;
    padding: 6px 10px;
    border-radius: 6px;
    color: #1f2937;
    cursor: pointer;
  }
  .lookup-dropdown-item:hover,
  .lookup-dropdown-item:focus {
    background: #eff6ff;
    outline: none;
  }
  .lookup-dropdown-item.is-selected {
    background: #dbe9ff;
    font-weight: 600;
  }
  @@media (max-width: 1100px) {
    .matinfo-grid {
      grid-template-columns: 110px 1fr 110px 1fr;
    }
    .matinfo-split {
      grid-template-columns: 1fr;
    }
  }
  @@media (max-width: 760px) {
    .matinfo-grid {
      grid-template-columns: 110px 1fr;
    }
    .matinfo-grid .field-wide,
    .matinfo-grid .field-full {
      grid-column: span 1;
    }
  }
</style>

<div class="matinfo-page" data-item-id="@Model.ItemId">
  <div class="matinfo-toolbar">
    <div class="btn-toolbar matinfo-toolbar-actions" role="group" aria-label="料號主檔操作">
      <button type="button" class="btn toolbar-btn toolbar-btn-icon" id="btnMatInfoTabFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
      <button type="button" class="btn toolbar-btn toolbar-btn-icon" id="btnMatInfoTabPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
      <button type="button" class="btn toolbar-btn toolbar-btn-icon" id="btnMatInfoTabNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
      <button type="button" class="btn toolbar-btn toolbar-btn-icon" id="btnMatInfoTabLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
      <div id="singleGridCountBox" class="toolbar-count-box mode-view">
        <div id="singleGridMode" class="count-line">瀏覽模式</div>
        <div id="singleGridCount" class="count-line">0 / 0</div>
      </div>
      <button type="button" class="btn toolbar-btn" id="btnMatInfoQuery"><i class="bi bi-search"></i>查詢</button>
      @if (!isQueryMat)
      {
        <button type="button" class="btn toolbar-btn" id="btnMatInfoEdit"><i class="bi bi-pencil-square"></i>修改</button>
        <button type="button" class="btn toolbar-btn warning" id="btnMatInfoCancel" hidden><i class="bi bi-x-circle"></i>取消</button>
        <button type="button" class="btn toolbar-btn" id="btnMatInfoAdd"><i class="bi bi-plus-lg"></i>新增</button>
        @if (!isProductMat)
        {
          <button type="button" class="btn toolbar-btn warning" id="btnMatInfoToFormal"><i class="bi bi-arrow-right-circle"></i>轉正式</button>
          <button type="button" class="btn toolbar-btn" id="btnMatInfoDetail"><i class="bi bi-list-ul"></i>明細</button>
        }
      }
      <button type="button" class="btn toolbar-btn" id="btnMatInfoHistory"><i class="bi bi-clock-history"></i>歷史</button>
      @if (!isQueryMat)
      {
        <button type="button" class="btn toolbar-btn warning" id="btnMatInfoToEmo"><i class="bi bi-arrow-repeat"></i>轉工程</button>
        <button type="button" class="btn toolbar-btn danger" id="btnMatInfoDelete"><i class="bi bi-trash3"></i>刪除</button>
        @if (!isProductMat)
        {
          <button type="button" class="btn toolbar-btn success" id="btnMatInfoSave"><i class="bi bi-check2-circle"></i>儲存</button>
        }
      }
      <button type="button" class="btn toolbar-btn" id="btnMatInfoSaveHeight">儲存高度</button>
      @if (!isQueryMat)
      {
        <button type="button" class="btn toolbar-btn" id="btnMatInfoCopyPN4YX">客戶版本複製</button>
        <button type="button" class="btn toolbar-btn" id="btnMatInfoUpdateCustPn">修改客戶料號</button>
      }
    </div>
  </div>

  <div class="matinfo-browse" id="matinfo-browse">
    <div class="matinfo-scroll-top" id="matinfo-browse-scroll-top"><div></div></div>
    <div class="matinfo-scroll-body" id="matinfo-browse-scroll-body">
      <table>
        <thead>
          <tr id="matinfo-browse-head"></tr>
        </thead>
        <tbody id="matinfo-browse-body"></tbody>
      </table>
    </div>
  </div>
  <div class="matinfo-browse-resizer" id="matinfo-browse-resizer"></div>

  <ul class="nav nav-tabs matinfo-tabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-basic" type="button" role="tab" data-tab-name="基本資料">基本資料</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-basic2" type="button" role="tab" data-tab-name="基本資料2">基本資料2</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-cust" type="button" role="tab" data-tab-name="廠商料號">廠商料號</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-prop" type="button" role="tab" data-tab-name="屬性及備註">屬性及備註</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-map" type="button" role="tab" data-tab-name="工程圖">工程圖</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-glyph" type="button" role="tab" data-tab-name="圖檔">圖檔</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-spec" type="button" role="tab" data-tab-name="規格表">規格表</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-unit" type="button" role="tab" data-tab-name="替代單位設定">替代單位設定</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-common" type="button" role="tab" data-tab-name="共用件">共用件</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link tab-compact" data-bs-toggle="tab" data-bs-target="#tab-kit" type="button" role="tab" data-tab-name="組合商品">組合商品</button>
    </li>
  </ul>

  <div class="matinfo-scroll-top" id="matinfo-form-scroll-top"><div></div></div>
  <div class="tab-content matinfo-form" id="matinfo-form-scroll-body">
    <div class="tab-pane fade show active" id="tab-basic" role="tabpanel" data-tab-name="基本資料">
      <div class="matinfo-abs-layout" id="matinfo-basic1-abs"></div>
      <div class="matinfo-grid">
        <label>料號</label>
        <input data-field="Partnum" readonly>
        <label>版序</label>
        <input data-field="Revision" readonly>
        <label>等級</label>
        <input data-field="Grade">

        <label>品名</label>
        <input class="field-wide" data-field="MatName">

        <label>單位</label>
        <input data-field="Unit">
        <label>用途</label>
        <input data-field="UseIn">
        <label>分類</label>
        <input data-field="MatClass">

        <label>長(英吋)</label>
        <input data-field="Length">
        <label>寬(英吋)</label>
        <input data-field="Width">
        <label>LLPCS</label>
        <input data-field="LLPCS">

        <label>圖號</label>
        <input class="field-wide" data-field="MapNo">

        <label>舊料號</label>
        <input class="field-wide" data-field="OldPartNum">

        <label>規格/機種</label>
        <input class="field-wide" data-field="EngGauge">

        <label>正式料號</label>
        <input data-field="NewPartNum" readonly>
        <label>建立者</label>
        <input data-field="Build_UserId" readonly>
        <label>建立日</label>
        <input data-field="Build_Date" readonly>

        <label>報價單位</label>
        <input data-field="UnitQuote">
        <label>換算式</label>
        <input data-field="ChangRate">
        <label>QC類型</label>
        <input data-field="QCType">

        <label>併版料號A</label>
        <input data-field="MergePartNum">
        <label>併版料號M</label>
        <input data-field="MerMPartNum">
        <label>來源料號</label>
        <input data-field="FromTmpPartNum" readonly>

        <label>寄銷廠商</label>
        <input data-field="AgentCompanyId">
        <label>HDI</label>
        <input data-field="HDI">
        <label>文字代碼</label>
        <input data-field="WordNum">

        <label>產品類別</label>
        <input data-field="ProdStyle">
        <label>轉廠別</label>
        <input data-field="TranFacType">
        <label>狀態</label>
        <input data-field="iPNStatus">

        <label>終端客戶</label>
        <input class="field-wide" data-field="YsLayer_s5">

        <label>狀態勾選</label>
        <div class="matinfo-checks field-wide">
          <label><input type="checkbox" data-field="MB"> 購入</label>
          <label><input type="checkbox" data-field="IsTrans"> 已轉正式</label>
          <label><input type="checkbox" data-field="IsEMO"> 已轉工程</label>
          <label><input type="checkbox" data-field="Status"> 正式料號</label>
          <label><input type="checkbox" data-field="StopOrder"> 停止下單</label>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-basic2" role="tabpanel" data-tab-name="基本資料2">
      <div class="matinfo-section">
        <div class="matinfo-section-title">基本資料2</div>
        <div class="matinfo-box">
          <div class="matinfo-abs-layout" id="matinfo-basic2-abs"></div>
          <div class="matinfo-grid" id="matinfo-basic2-grid"></div>
          <div class="text-muted" id="matinfo-basic2-empty">沒有可顯示欄位</div>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-cust" role="tabpanel" data-tab-name="廠商料號">
      <div class="matinfo-section">
        <div class="matinfo-section-title">廠商料號</div>
        <div class="matinfo-box" id="matinfo-cust-wrap">
          <div class="matinfo-grid-toolbar">
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCustFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCustPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCustNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCustLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
            <button type="button" class="btn btn-outline-success btn-icon" id="btnCustAdd" title="新增" aria-label="新增"><i class="bi bi-plus-lg"></i></button>
            <button type="button" class="btn btn-outline-danger btn-icon" id="btnCustDelete" title="刪除" aria-label="刪除"><i class="bi bi-dash-lg"></i></button>
            <button type="button" class="btn btn-outline-primary btn-icon" id="btnCustSave" title="儲存" aria-label="儲存"><i class="bi bi-check-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCustCancel" title="取消" aria-label="取消"><i class="bi bi-x-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCustRefresh" title="重新整理" aria-label="重新整理"><i class="bi bi-arrow-clockwise"></i></button>
          </div>
          <div class="matinfo-grid-table">
            <table id="matinfo-cust-table">
            <thead>
              <tr>
                <th style="width: 120px;">客戶代碼</th>
                <th style="width: 140px;">客戶簡稱</th>
                <th style="width: 200px;">客戶品號</th>
                <th style="width: 200px;">物品說明</th>
                <th style="width: 160px;">材質</th>
                <th style="width: 140px;">尺寸</th>
                <th style="width: 160px;">機械性質</th>
                <th style="width: 160px;">貿易條款</th>
                <th style="width: 160px;">交貨狀態</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="9">尚未接廠商料號資料</td>
              </tr>
            </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
          <div class="tab-pane fade" id="tab-stock" role="tabpanel" data-tab-name="庫存設定">
      <div class="matinfo-section">
        <div class="matinfo-section-title">庫存設定</div>
        <div class="matinfo-grid">
          <label>最小包裝量</label>
          <input data-field="LeastBag">
          <label>最小訂購量</label>
          <input data-field="OrderQnty">
          <label>超收%</label>
          <input data-field="Accept">

          <label>Lead Time</label>
          <input data-field="LeadTime">
          <label>安全庫存</label>
          <input data-field="SafeQnty">
          <label>固定補足量</label>
          <input data-field="FixQnty">

          <label>固定補足時間</label>
          <input data-field="FixDate">
          <label>安全點天數</label>
          <input data-field="SafeDay">
          <label>耗損率%</label>
          <input data-field="ScrapRate">

          <label>保存天數</label>
          <input data-field="KeepTime">
          <label>平均月用量</label>
          <input data-field="AvgMonQnty" readonly>
          <label>平均日用量</label>
          <input data-field="AvgDayQnty" readonly>

          <label>記錄平均用量起</label>
          <input data-field="SetFromDate">
          <label>迄</label>
          <input data-field="SetDueDate">
          <label>現有庫存</label>
          <input data-field="StockQnty" readonly>

          <label>物料型態</label>
          <input data-field="MatClassType">
          <label>耗用分類</label>
          <input data-field="AccountType">
          <label>倉別</label>
          <input data-field="StockId">

          <label>庫位</label>
          <input data-field="PosId">
          <label>自訂分類一</label>
          <input data-field="MatClass1">
          <label>自訂分類二</label>
          <input data-field="MatClass2">

          <label>管理</label>
          <div class="matinfo-checks field-wide">
            <label><input type="checkbox" data-field="iNeedBatchNum"> 批號管理</label>
            <label><input type="checkbox" data-field="iNeedDateCode"> DateCode 管理</label>
            <label><input type="checkbox" data-field="iNeedExpiredDate"> 效期管制</label>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-prop" role="tabpanel" data-tab-name="屬性及備註">
      <div class="matinfo-split">
        <div class="matinfo-box" id="matinfo-prop-wrap">
          <div class="matinfo-section-title">屬性清單</div>
          <table id="matinfo-prop-table">
            <thead>
              <tr>
                <th style="width: 70px;">屬性</th>
                <th style="width: 140px;">屬性名</th>
                <th style="width: 140px;">項目</th>
                <th style="width: 180px;">項目名</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4">尚未接屬性明細資料</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="matinfo-box">
          <div class="matinfo-section-title">備註</div>
          <textarea class="matinfo-textarea" data-field="Notes"></textarea>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-map" role="tabpanel" data-tab-name="工程圖">
      <div class="matinfo-section">
        <div class="matinfo-section-title">工程圖清單</div>
        <div class="matinfo-map-toolbar">
          <div class="matinfo-grid-toolbar">
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnMapFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnMapPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnMapNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnMapLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
            <button type="button" class="btn btn-outline-success btn-icon" id="btnMapAdd" title="新增" aria-label="新增"><i class="bi bi-plus-lg"></i></button>
            <button type="button" class="btn btn-outline-danger btn-icon" id="btnMapDelete" title="刪除" aria-label="刪除"><i class="bi bi-dash-lg"></i></button>
            <button type="button" class="btn btn-outline-primary btn-icon" id="btnMapSave" title="儲存" aria-label="儲存"><i class="bi bi-check-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnMapCancel" title="取消" aria-label="取消"><i class="bi bi-x-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnMapRefresh" title="重新整理" aria-label="重新整理"><i class="bi bi-arrow-clockwise"></i></button>
          </div>
          <div class="matinfo-toolbar-actions">
            <button type="button" class="btn toolbar-btn" id="btnMapSetPath">指定路徑及檔名</button>
            <button type="button" class="btn toolbar-btn" id="btnMapViewWindow">檢視圖檔 (開視窗)</button>
            <button type="button" class="btn toolbar-btn" id="btnMapViewGlyph">檢視圖檔 (跳至圖檔頁籤)</button>
          </div>
        </div>
        <div class="matinfo-box" id="matinfo-map-wrap">
          <div class="matinfo-grid-table">
            <table id="matinfo-map-table">
            <thead>
              <tr>
                <th style="width: 70px;">序號</th>
                <th>圖檔完整路徑及檔名</th>
                <th style="width: 220px;">說明</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">尚未接工程圖資料</td>
              </tr>
            </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-glyph" role="tabpanel" data-tab-name="圖檔">
      <div class="matinfo-section">
        <div class="matinfo-section-title">圖檔</div>
        <div class="matinfo-grid">
          <label>料號</label>
          <input data-field="Partnum" readonly>
          <label>品名</label>
          <input data-field="MatName" readonly>
          <label>圖檔序號</label>
          <input data-field="SerialNum" readonly>
        </div>
      </div>
      <div class="matinfo-image-box">
        <img id="matinfo-glyph-image" alt="圖檔預覽" style="display:none; max-width: 100%; max-height: 100%;">
        <iframe id="matinfo-glyph-frame" title="圖檔預覽" style="display:none; width:100%; height:100%; border:0; background:#fff;"></iframe>
        <div id="matinfo-glyph-empty">無 圖 檔</div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-demand" role="tabpanel" data-tab-name="成品要求">
      <div class="matinfo-section">
        <div class="matinfo-section-title">成品要求</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 70px;">代號</th>
                <th style="width: 200px;">要求名稱</th>
                <th style="width: 120px;">需要有值</th>
                <th>要求內容</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4">尚未接成品要求資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-spec" role="tabpanel" data-tab-name="規格表">
      <div class="matinfo-section">
        <div class="matinfo-section-title">規格表</div>
        <div class="matinfo-grid-toolbar matinfo-spec-toolbar show-nav">
          <div class="matinfo-grid-toolbar matinfo-spec-nav show-nav">
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnSpecFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnSpecPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnSpecNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnSpecLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
            <button type="button" class="btn btn-outline-primary btn-icon" id="btnSpecSave" title="儲存" aria-label="儲存"><i class="bi bi-check-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnSpecCancel" title="取消" aria-label="取消"><i class="bi bi-x-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnSpecRefresh" title="重新整理" aria-label="重新整理"><i class="bi bi-arrow-clockwise"></i></button>
          </div>
          <div class="matinfo-grid matinfo-spec-filters">
            <label>單號</label>
            <input data-field="PaperNum" readonly>
            <label>種類</label>
            <select id="specTypeSelect" data-field="SpecType"></select>
            <label>名稱</label>
            <input data-field="Lk_SpecTypeName" readonly>
          </div>
          <div class="matinfo-toolbar-actions matinfo-spec-actions">
            <button type="button" class="btn toolbar-btn" id="btnSpecReimport">重新匯入</button>
            <button type="button" class="btn toolbar-btn" id="btnSpecClear">全部清除</button>
            <button type="button" class="btn toolbar-btn" id="btnSpecPrint">承委單列印</button>
          </div>
        </div>
    </div>
      <div class="matinfo-box" id="matinfo-spec-wrap">
        <div class="matinfo-grid-table">
          <table id="matinfo-spec-table">
            <thead>
              <tr>
                <th style="width: 70px;">代號</th>
                <th style="width: 180px;">屬性名</th>
                <th>屬性內容</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">尚未接規格表資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-unit" role="tabpanel" data-tab-name="替代單位設定">
      <div class="matinfo-section">
        <div class="matinfo-section-title">替代單位設定</div>
        <div class="matinfo-box" id="matinfo-unit-wrap">
          <div class="matinfo-grid-toolbar">
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnUnitFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnUnitPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnUnitNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnUnitLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
            <button type="button" class="btn btn-outline-success btn-icon" id="btnUnitAdd" title="新增" aria-label="新增"><i class="bi bi-plus-lg"></i></button>
            <button type="button" class="btn btn-outline-danger btn-icon" id="btnUnitDelete" title="刪除" aria-label="刪除"><i class="bi bi-dash-lg"></i></button>
            <button type="button" class="btn btn-outline-primary btn-icon" id="btnUnitSave" title="儲存" aria-label="儲存"><i class="bi bi-check-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnUnitCancel" title="取消" aria-label="取消"><i class="bi bi-x-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnUnitRefresh" title="重新整理" aria-label="重新整理"><i class="bi bi-arrow-clockwise"></i></button>
          </div>
          <div class="matinfo-grid-table">
            <table id="matinfo-unit-table">
            <thead>
              <tr>
                <th style="width: 120px;">替代單位</th>
                <th style="width: 120px;">換算比</th>
                <th style="width: 140px;">用途類型</th>
                <th>備註</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4">尚未接替代單位資料</td>
              </tr>
            </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-common" role="tabpanel" data-tab-name="共用件">
      <div class="matinfo-section">
        <div class="matinfo-section-title">共用件</div>
        <div class="matinfo-box" id="matinfo-common-wrap">
          <div class="matinfo-grid-table">
            <table id="matinfo-common-table">
              <thead>
                <tr>
                  <th style="width: 70px;">序號</th>
                  <th style="width: 140px;">共用料號</th>
                  <th style="width: 200px;">品名</th>
                  <th style="width: 120px;">使用量</th>
                  <th style="width: 120px;">基礎用量</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="5">尚未接共用件資料</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="matinfo-grid-toolbar show-nav matinfo-common-toolbar">
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCommonFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCommonPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCommonNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCommonLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
            <button type="button" class="btn btn-outline-success btn-icon" id="btnCommonAdd" title="新增" aria-label="新增"><i class="bi bi-plus-lg"></i></button>
            <button type="button" class="btn btn-outline-danger btn-icon" id="btnCommonDelete" title="刪除" aria-label="刪除"><i class="bi bi-dash-lg"></i></button>
            <button type="button" class="btn btn-outline-primary btn-icon" id="btnCommonSave" title="儲存" aria-label="儲存"><i class="bi bi-check-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCommonCancel" title="取消" aria-label="取消"><i class="bi bi-x-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnCommonRefresh" title="重新整理" aria-label="重新整理"><i class="bi bi-arrow-clockwise"></i></button>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-avl" role="tabpanel" data-tab-name="廠商AVL">
      <div class="matinfo-section">
        <div class="matinfo-section-title">廠商 AVL</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 70px;">序號</th>
                <th style="width: 120px;">供應商</th>
                <th style="width: 140px;">供應商名稱</th>
                <th style="width: 100px;">UOM</th>
                <th style="width: 120px;">UOM數量</th>
                <th style="width: 120px;">數量</th>
                <th style="width: 120px;">單價</th>
                <th style="width: 120px;">幣別</th>
                <th style="width: 100px;">匯率</th>
                <th style="width: 140px;">付款方式</th>
                <th style="width: 140px;">發票種類</th>
                <th style="width: 140px;">報價日</th>
                <th style="width: 140px;">有效日</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="13">尚未接廠商 AVL 資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-cusprice" role="tabpanel" data-tab-name="客戶價格表">
      <div class="matinfo-section">
        <div class="matinfo-section-title">客戶價格表</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 70px;">序號</th>
                <th style="width: 120px;">客戶</th>
                <th style="width: 140px;">客戶名稱</th>
                <th style="width: 100px;">UOM</th>
                <th style="width: 120px;">UOM數量</th>
                <th style="width: 120px;">數量</th>
                <th style="width: 120px;">單價</th>
                <th style="width: 120px;">幣別</th>
                <th style="width: 100px;">匯率</th>
                <th style="width: 140px;">付款方式</th>
                <th style="width: 140px;">發票種類</th>
                <th style="width: 140px;">報價日</th>
                <th style="width: 140px;">有效日</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="13">尚未接客戶價格表資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-price" role="tabpanel" data-tab-name="價格">
      <div class="matinfo-section">
        <div class="matinfo-section-title">價格</div>
        <div class="matinfo-grid compact">
          <label>標準成本單價</label>
          <input data-field="STDCostUp">
          <label>價格1</label>
          <input data-field="UnitPrice1">
          <label>價格2</label>
          <input data-field="UnitPrice2">
          <label>價格3</label>
          <input data-field="UnitPrice3">
          <label>價格4</label>
          <input data-field="UnitPrice4">
          <label>價格5</label>
          <input data-field="UnitPrice5">
          <label>價格6</label>
          <input data-field="UnitPrice6">
          <label>價格7</label>
          <input data-field="UnitPrice7">
          <label>價格8</label>
          <input data-field="UnitPrice8">
          <label>價格9</label>
          <input data-field="UnitPrice9">
          <label>價格10</label>
          <input data-field="UnitPrice10">
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-notes" role="tabpanel" data-tab-name="其他備註">
      <div class="matinfo-section">
        <div class="matinfo-section-title">其他備註 (文字)</div>
        <div class="matinfo-grid compact">
          <label>備註1(文字)</label>
          <input data-field="NotesVarch1">
          <label>備註2(文字)</label>
          <input data-field="NotesVarch2">
          <label>備註3(文字)</label>
          <input data-field="NotesVarch3">
          <label>備註4(文字)</label>
          <input data-field="NotesVarch4">
          <label>備註5(文字)</label>
          <input data-field="NotesVarch5">
          <label>備註6(文字)</label>
          <input data-field="NotesVarch6">
          <label>備註7(文字)</label>
          <input data-field="NotesVarch7">
          <label>備註8(文字)</label>
          <input data-field="NotesVarch8">
          <label>備註9(文字)</label>
          <input data-field="NotesVarch9">
          <label>備註10(文字)</label>
          <input data-field="NotesVarch10">
        </div>
      </div>
      <div class="matinfo-section">
        <div class="matinfo-section-title">其他備註 (數字)</div>
        <div class="matinfo-grid compact">
          <label>備註11(數字)</label>
          <input data-field="NotesDecim1">
          <label>備註12(數字)</label>
          <input data-field="NotesDecim2">
          <label>備註13(數字)</label>
          <input data-field="NotesDecim3">
          <label>備註14(數字)</label>
          <input data-field="NotesDecim4">
          <label>備註15(數字)</label>
          <input data-field="NotesDecim5">
          <label>備註16(數字)</label>
          <input data-field="NotesDecim6">
          <label>備註17(數字)</label>
          <input data-field="NotesDecim7">
          <label>備註18(數字)</label>
          <input data-field="NotesDecim8">
          <label>備註19(數字)</label>
          <input data-field="NotesDecim9">
          <label>備註20(數字)</label>
          <input data-field="NotesDecim10">
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-packing" role="tabpanel" data-tab-name="Packing">
      <div class="matinfo-section">
        <div class="matinfo-section-title">Packing</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 70px;">項次</th>
                <th style="width: 120px;">箱型</th>
                <th style="width: 120px;">數量</th>
                <th>備註</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4">尚未接 Packing 資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-kit" role="tabpanel" data-tab-name="組合商品">
      <div class="matinfo-section">
        <div class="matinfo-section-title">組合商品</div>
        <div class="matinfo-box" id="matinfo-kit-wrap">
          <div class="matinfo-grid-toolbar">
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnKitFirst" title="第一筆" aria-label="第一筆"><i class="bi bi-chevron-bar-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnKitPrev" title="上一筆" aria-label="上一筆"><i class="bi bi-chevron-left"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnKitNext" title="下一筆" aria-label="下一筆"><i class="bi bi-chevron-right"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnKitLast" title="最後一筆" aria-label="最後一筆"><i class="bi bi-chevron-bar-right"></i></button>
            <button type="button" class="btn btn-outline-success btn-icon" id="btnKitAdd" title="新增" aria-label="新增"><i class="bi bi-plus-lg"></i></button>
            <button type="button" class="btn btn-outline-danger btn-icon" id="btnKitDelete" title="刪除" aria-label="刪除"><i class="bi bi-dash-lg"></i></button>
            <button type="button" class="btn btn-outline-primary btn-icon" id="btnKitSave" title="儲存" aria-label="儲存"><i class="bi bi-check-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnKitCancel" title="取消" aria-label="取消"><i class="bi bi-x-lg"></i></button>
            <button type="button" class="btn btn-outline-secondary btn-icon" id="btnKitRefresh" title="重新整理" aria-label="重新整理"><i class="bi bi-arrow-clockwise"></i></button>
          </div>
          <div class="matinfo-grid-table">
            <table id="matinfo-kit-table">
              <thead>
                <tr>
                  <th style="width: 80px;">項次</th>
                  <th style="width: 160px;">組合料號</th>
                  <th style="width: 200px;">品名</th>
                  <th style="width: 100px;">單位</th>
                  <th style="width: 120px;">數量</th>
                  <th>備註</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6">尚未接組合商品資料</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-delivery" role="tabpanel" data-tab-name="廠商送貨明細檔">
      <div class="matinfo-section">
        <div class="matinfo-section-title">廠商送貨明細檔</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 70px;">項次</th>
                <th style="width: 160px;">標題</th>
                <th style="width: 120px;">倉別</th>
                <th style="width: 120px;">庫位</th>
                <th>備註</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5">尚未接送貨明細資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-depart" role="tabpanel" data-tab-name="部門領料倉別明細檔">
      <div class="matinfo-section">
        <div class="matinfo-section-title">部門領料倉別明細檔</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 120px;">部門代碼</th>
                <th style="width: 160px;">部門名稱</th>
                <th style="width: 120px;">倉別</th>
                <th style="width: 120px;">庫位</th>
                <th>備註</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5">尚未接部門領料資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="tab-engrave" role="tabpanel" data-tab-name="射出紀錄">
      <div class="matinfo-section">
        <div class="matinfo-section-title">射出紀錄</div>
        <div class="matinfo-box">
          <table>
            <thead>
              <tr>
                <th style="width: 120px;">項次</th>
                <th style="width: 200px;">內容</th>
                <th>備註</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">尚未接射出紀錄資料</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</div>

<div class="modal fade" id="matinfo-log-modal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">歷史紀錄</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="matinfo-section">
          <div class="matinfo-section-title">更新記錄</div>
          <div class="matinfo-box">
            <table id="matinfo-log-master">
              <thead></thead>
              <tbody>
                <tr><td>尚無更新記錄</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="matinfo-section">
          <div class="matinfo-section-title">歷史</div>
          <div class="matinfo-box">
            <table id="matinfo-log-history">
              <thead></thead>
              <tbody>
                <tr><td>尚無歷史記錄</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

@await Html.PartialAsync("~/Pages/CustomButton/MatInfoAdd.cshtml", null, ViewData)
@await Html.PartialAsync("~/Pages/CustomButton/MatInfoSearch.cshtml", null, ViewData)
@await Html.PartialAsync("~/Pages/Shared/_FieldDictModal.cshtml", null, ViewData)

@section Scripts {
<script src="~/js/editableGrid.js" asp-append-version="true"></script>
<script src="~/js/fieldDictModal.js" asp-append-version="true"></script>

<script src="~/js/matinfoCom.js" asp-append-version="true"></script>

}
